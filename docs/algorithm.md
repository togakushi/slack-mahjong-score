# アルゴリズム

## 検索アルゴリズム
1. 過去ログから「設定キーワード({keyword})」を含むすべてのメッセージを検索
2. メッセージ内の改行と空白を削除
3. 下記のパターンにマッチするメッセージを抽出
   - rf"^{keyword}([^0-9+-]+[0-9+-]+){{4}}$"
   - rf"([^0-9+-]+[0-9+-]+){{4}}{keyword}$"

## 名前表記ブレ修正アルゴリズム
1. 検索で抽出されたメッセージからキーワード「設定キーワード({keyword})」を削除
2. すべての空白と改行を削除
3. 「([^0-9+-]+)([0-9+-]+)」を4回繰り返したパターンにマッチさせ、名前と素点を分離
4. 登録メンバー名と名前を比較
5. 一致しない場合は以下の処理をおこない、登録メンバー名と比較
   1. 敬称を削除して比較（さん、くん、ちゃんなど）
   2. カタカナ部分をひらがなに置換して比較
   3. ひらがな部分をカタカナに置換して比較
6. 登録メンバー名と一致しない名前は「ゲスト１」に置き換える

## ポイント集計アルゴリズム
1. 素点に含まれる計算式を計算した結果で置き換える
2. 同点があった場合に席順で差が出るように起家に「0.000004」点、南家に「0.000003」点・・・を北家まで加算していく
3. 素点だけの配列を新しく作り、数値の大きい順にソートする
4. 持ち点が素点の配列上の何番目にあるかを検索し、順位とする
5. 取得した順位をもとにウマ・オカを素点に加え、獲得ポイントを算出し名前とポイント(小数点第1位で切り捨て)を記録する
6. 集計対象のゲーム内に「ゲスト１」が1名以下の場合、名前をキーにしてポイントを加算していく
   - ゲストが2名以上同卓したゲームは集計対象外となる(2ゲスト戦)
   - 1ゲーム内のゲストの区別が付かず、2重に集計される
