# アルゴリズム

## 検索アルゴリズム
1. 過去ログから「御無礼」を含むすべてのメッセージを検索
2. 実行月の1日午前12時以降のメッセージを抽出
3. メッセージ内の改行を削除
4. 下記のパターンにマッチするメッセージを抽出

   - '^御無礼 ?([^0-9+-]+ ?[0-9+-]+ ?){4}'
   - ' ?[^0-9+-]+ ?[0-9+-]+ ?){4}御無礼$'

## 名前表記ブレ修正アルゴリズム
1. 検索で抽出されたメッセージからキーワード「御無礼」を削除
2. すべての空白を削除
3. 「([^0-9+-]+)([0-9+-]+)」を4回繰り返したパターンにマッチさせ、名前と素点を分離
4. 敬称の「さん」を削除
5. 登録リストと名前を順に比較し、一致したら名前を登録名と置き換える
6. 登録リストと一致しない名前は「ゲスト１」に置き換える

## ポイント集計アルゴリズム
1. 素点に含まれる計算式を計算した結果で置き換える
2. 同点があった場合に席順で差が出るように起家に「0.000004」点、南家に「0.000003」点・・・を北家まで加算していく
3. 素点だけの配列を新しく作り、数値の大きい順にソートする
4. 持ち点が素点の配列上の何番目にあるかを検索し、順位とする
5. 取得した順位をもとにウマ・オカを素点に加え、獲得ポイントを算出し名前とポイント(小数点第1位で切り捨て)を記録する
6. 集計対象の半荘内に「ゲスト１」が1名以下の場合、名前をキーにしてポイントを加算していく
   - ゲストが2名以上同卓した半荘は集計対象外となる
